"use strict";$(function(a){var t=document.forms[0],n=document.getElementById("img1"),i=document.getElementById("img2");new AjaxUpload("#upload",{action:Base.url(CONTROLLER,"upload"),complete:function(e){var m=e.data;e.code?(showMessage(e.msg),t.elements.img1.value=m.img1,t.elements.img2.value=m.img2,n.href=m.img1,i.src=m.img2,this.filename&&!t.elements.name.value&&(t.elements.name.value=this.filename)):showError(e.msg)}});var s=a("#album"),l=s.children("li").length;new AjaxUpload("#albumUpload",{action:Base.url(CONTROLLER,"uploads"),multiple:!0,complete:function(e){var m=e.data,t="";e.code?(showMessage(e.msg),a.each(m,function(e,m){m.key=l++,t+=Base.substitute('<li><img src="{img2}" /><span title="删除"></span><input type="hidden" name="album[{key}][img1]" value="{img1}"><input type="hidden" name="album[{key}][img2]" value="{img2}"></li>',m)}),s.append(t)):showError(e.msg)}}),s.on("click","span",function(){a(this).closest("li").remove()}),s.dragsort(),t.onsubmit=function(){return""===a.trim(this.elements.img1.value)?(showError("您还没有上传图片，请先上传图片！"),!1):""!==a.trim(this.elements.name.value)||(showError("请填写产品名称"),this.elements.name.focus(),!1)}});